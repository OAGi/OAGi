<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui" template="/WEB-INF/template.xhtml">

	<ui:define name="side_menu">
		<h:form>
			<p:growl id="messages" showDetail="false" />

			<p:menu>
				<p:submenu style="width: 180px !important;" label="Context Category">
					<p:menuitem value="List" url="context_category_list.xhtml" icon="ui-icon-create" />
					<p:menuitem value="Create" url="context_category_create.xhtml" icon="ui-icon-create" />
					<p:menuitem value="Search" url="context_category_search.xhtml" icon="ui-icon-search" />
				</p:submenu>
			</p:menu>
		</h:form>
	</ui:define>


	<ui:define name="content">
	<h:form id="form">
                 
    <p:growl id="growl" sticky="true" showDetail="true"/>
 
    <p:wizard flowListener="#{topLevelABIEHandler.onFlowProcess}">
        <p:tab id="select_tl_acc" title="Select top-level Concept">
			<p:growl id="messages1" />
			<p:panel header="Search Contents">
				<p:messages autoUpdate="true" />

				<h:panelGrid id="grid" columns="5" cellpadding="5">
					<h:outputLabel for="propertyTerm" value="ASCCP Property Term:" style="font-weight:bold" />
					<p:autoComplete id="propertyTerm" value="#{topLevelABIEHandler.propertyTerm}" completeMethod="#{topLevelABIEHandler.completeInput}" />
					<p:commandButton value="Search" ajax="true" actionListener="#{topLevelABIEHandler.search}" update="tbl" icon="ui-icon-search" />
				</h:panelGrid>
			</p:panel>
			<p:panel header="Top-level Concept List">
				<p:dataTable id="tbl" var="aSCCPVO" value="#{topLevelABIEHandler.asccpVOs}"
					paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} "
					paginator="true" rows="20" style="width:900px; margin-bottom:20px" selection="#{topLevelABIEHandler.selected}" rowKey="#{aSCCPVO.ASCCPID}" selectionMode="single">
					<p:ajax event="rowSelect" listener="#{topLevelABIEHandler.onRowSelect}" />
        			<p:ajax event="rowUnselect" listener="#{topLevelABIEHandler.onRowUnselect}" />
					<p:column style="width:350px">
						<f:facet name="header">
							<h:outputText value="ASCCP Property Term" />
						</f:facet>
						<h:outputText value="#{aSCCPVO.propertyTerm}" />
					</p:column>
	
					<p:column style="width:300px">
						<f:facet name="header">
							<h:outputText value="Module" />
						</f:facet>
						<h:outputText value="#{aSCCPVO.module}" />
					</p:column>
					
					<p:column style="width:180px">
						<f:facet name="header">
							<h:outputText value="Last Updated Time" />
						</f:facet>
						<h:outputText value="#{aSCCPVO.lastUpdateTimestamp}" />
					</p:column>
				
				</p:dataTable>
			</p:panel>
        </p:tab>
 
        <p:tab id="select_bc" title="Select Business Context">
       		<p:panel header="Selected Top-level Concept">
                <p:dataTable var="aSCCPVO" value="#{topLevelABIEHandler.selected}" style="width:900px; margin-bottom:20px">
				    <p:column headerText="ASCCP Property Term">
				        <h:outputText value="#{aSCCPVO.propertyTerm}" />
				    </p:column>
				 
				    <p:column headerText="Module">
				        <h:outputText value="#{aSCCPVO.module}" />
				    </p:column>
				 
				    <p:column headerText="Last Updated Time">
				        <h:outputText value="#{aSCCPVO.lastUpdateTimestamp}" />
				    </p:column>
				</p:dataTable>
            </p:panel>
            <p:panel header="Select Existing Business Context" collapsed="true" toggleable="true" toggleSpeed="500">
            	<h:panelGrid columns="2" columnClasses="label, value" cellpadding="10" cellspacing="2">
            		<h:outputLabel value="Seletced: " style="font-weight:bold; color:red;" />
            		<h:outputLabel id="selectedBC" value="#{topLevelABIEHandler.bCSelected.name}" style="font-weight:bold; color:blue;" />
            	</h:panelGrid>
                <h:panelGrid columns="1" columnClasses="label, value">
					<p:dataTable id="tbl1" var="BusinessContextVO" value="#{businessContextHandler.businessContexts}"
						paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} "
						paginator="true" rows="10" style="width:400px; margin-bottom:20px" selection="#{businessContextHandler.bcDetail}" rowKey="#{BusinessContextVO.businessContextID}">
				        <p:column selectionMode="single" style="width:16px;text-align:center"/>
						<p:column style="width:200px">
							<f:facet name="header">
								<h:outputText value="Name" />
							</f:facet>
							<h:outputText value="#{BusinessContextVO.name}" />
						</p:column>
						
					</p:dataTable>
					<p:commandButton process="tbl1" update=":form:bcDetailid" icon="ui-icon-search" value="Detail" oncomplete="PF('bcDetail').show()" />
					<p:dialog header="Business Context Detail" widgetVar="bcDetail" showEffect="clip" hideEffect="clip" closable="true" resizable="true" draggable="true" width="800" height="300">
		        		<p:outputPanel id="bcDetailid">
							<h:panelGrid id="grid1" cellpadding="5">
								<p:row>
			        				<p:column style="width:200px"> 
										<h:outputLabel value="Name: " style="font-weight:bold" />
									</p:column> 
									<p:column style="width:600px"> 
										<h:outputText value="#{businessContextHandler.bcDetail.name}" />
									</p:column> 
								</p:row>
								<p:row>
									<p:column> 
										<h:outputLabel for="desc" value="Business Context Value "
											style="font-weight:bold" />
									</p:column>
									<p:column>
									</p:column> 
								</p:row>		
								<p:row>
									<p:column colspan="2"> 					
										<p:dataTable id="tbl21" var="businessContextValues" value="#{businessContextHandler.bcDetails}"
											style="width:600px; margin-bottom:20px">
											
											<p:column style="width:200px">
												<f:facet name="header">
													<h:outputText value="Context Category" />
												</f:facet>
												<h:outputText value="#{businessContextValues.ccVO.name}" />
											</p:column>
							
											<p:column style="width:200px">
												<f:facet name="header">
													<h:outputText value="Context Scheme Name" />
												</f:facet>
												<h:outputText value="#{businessContextValues.csVO.schemeName}" />
											</p:column>
							
											<p:column style="width:200px">
												<f:facet name="header">
													<h:outputText value="Context Scheme Value" />
												</f:facet>
												<h:outputText value="#{businessContextValues.csvVO.value}" />
											</p:column>
										</p:dataTable>
									</p:column>
								</p:row>
								<p:row>
									<p:commandButton value="Select" icon="ui-icon-check"
										style="margin-right:10px" actionListener="#{topLevelABIEHandler.onBCSelect(businessContextHandler.bcDetail)}" oncomplete="PF('bcDetail').hide()" update=":form:selectedBC :form:selectedBC1" />
									<p:commandButton value="Close" icon="ui-icon-check"
										style="margin-right:10px" oncomplete="PF('bcDetail').hide()" />
								</p:row>
							</h:panelGrid>
						</p:outputPanel>
				    </p:dialog>
                </h:panelGrid>
            </p:panel>
            <p:panel header="Create New Business Context" collapsed="true" toggleable="true" toggleSpeed="500">
                <h:panelGrid columns="2" columnClasses="label, value" cellpadding="10" cellspacing="2">
            		<h:outputLabel value="Seletced: " style="font-weight:bold; color:red;" />
            		<h:outputLabel id="selectedBC1" value="#{topLevelABIEHandler.bCSelected.name}" style="font-weight:bold; color:blue;" />
            	</h:panelGrid>

				<h:panelGrid id="grid2" cellpadding="5">
					<p:row>
        				<p:column style="width:200px"> 
							<h:outputLabel value="Name: " style="font-weight:bold" />
						</p:column> 
						<p:column style="width:600px"> 
							<p:inputText id="name" value="#{businessContextHandler.name}"
								label="Name" />
						</p:column> 
					</p:row>
					<p:row>
						<p:column> 
							<h:outputLabel for="desc" value="Business Context Value "
								style="font-weight:bold" />
						</p:column>
						<p:column>
							<p:commandButton value="Add" icon="ui-icon-extlink" actionListener="#{businessContextHandler.chooseCV}">
						        <p:ajax event="dialogReturn" listener="#{businessContextHandler.onCCChosen}" update=":form:tbl2" />
						    </p:commandButton>
						</p:column> 
					</p:row>		
					<p:row>
						<p:column colspan="2"> 					
							<p:dataTable id="tbl2" var="businessContextValues" value="#{businessContextHandler.bcValues}"
								style="width:600px; margin-bottom:20px">
								
								<p:column style="width:200px">
									<f:facet name="header">
										<h:outputText value="Context Category" />
									</f:facet>
									<h:outputText value="#{businessContextValues.ccVO.name}" />
								</p:column>
				
								<p:column style="width:200px">
									<f:facet name="header">
										<h:outputText value="Context Scheme Name" />
									</f:facet>
									<h:outputText value="#{businessContextValues.csVO.schemeName}" />
								</p:column>
				
								<p:column style="width:200px">
									<f:facet name="header">
										<h:outputText value="Context Scheme Value" />
									</f:facet>
									<h:outputText value="#{businessContextValues.csValues}" />
								</p:column>
							</p:dataTable>
						</p:column>
					</p:row>
					<p:row>
        				<p:column>
							<p:commandButton value="Create" update=":form:selectedBC :form:selectedBC1" icon="ui-icon-check"
							validateClient="true" style="margin-right:10px" actionListener="#{topLevelABIEHandler.onBCSelect(businessContextHandler)}" />
						</p:column>
					</p:row>
				</h:panelGrid>
            </p:panel>
            
<!--             <p:ajaxStatus onstart="PF('statusDialog').show()" onsuccess="PF('statusDialog').hide()" />
 
			<p:dialog widgetVar="statusDialog" modal="false" draggable="false" closable="false" resizable="false" showHeader="false">
			    <p:graphicImage name="images/ajaxloadingbar.gif" />
			</p:dialog> -->
            
        </p:tab>
 
        <p:tab id="create_u_bie" title="Create uncommitted BIE">
        	<p:panel header="Create uncommitted BIE">
		        <p:treeTable value="#{topLevelABIEHandler.root}" var="aBIEView">
			        <f:facet name="header">
			            #{topLevelABIEHandler.selected.module}
			        </f:facet>
			        <p:column headerText="Children">
			            <h:outputText value="#{aBIEView.name}" style="color:#{aBIEView.color};"/>
			        </p:column>
			        <p:column headerText="Min">
			            <h:outputText value="#{aBIEView.min}" />
			        </p:column>
			        <p:column headerText="Max">
			            <h:outputText value="#{aBIEView.max}" />
			        </p:column>
			        <p:column headerText="Primitive">
			            <h:outputText value="#{aBIEView.primitive}" />
			        </p:column>
			        <p:column headerText="Fixed Value">
			            <h:outputText value="#{aBIEView.fixedValue}" />
			        </p:column>
			        <p:column style="width:24px">
			            <p:commandLink update=":form:documentPanel" oncomplete="PF('documentDialog').show()" title="View Detail" styleClass="ui-icon ui-icon-search">
			                <f:setPropertyActionListener value="#{document}" target="#{topLevelABIEHandler.selectedDocument}" />
			            </p:commandLink>
			        </p:column>
			    </p:treeTable>
			 
			    <p:dialog id="dialog" header="Document Detail" showEffect="fade" widgetVar="documentDialog" modal="false" resizable="false">
			        <p:outputPanel id="documentPanel">
			            <p:panelGrid  columns="2" columnClasses="label,value" rendered="#{not empty topLevelABIEHandler.selectedDocument}">
			                <h:outputLabel for="children" value="Children" />
			                <h:outputText id="children" value="#{topLevelABIEHandler.selectedDocument.name}" style="font-weight:bold" />
			 
			                <h:outputLabel for="min" value="Min" />
			                <h:outputText id="min" value="#{topLevelABIEHandler.selectedDocument.size}" style="font-weight:bold" />
			 
			                <h:outputLabel for="max" value="Max " />
			                <h:outputText id="max" value="#{topLevelABIEHandler.selectedDocument.type}" style="font-weight:bold" />
			            </p:panelGrid>
			        </p:outputPanel>
			    </p:dialog>
			   </p:panel>
            <p:panel header="Number of Uncommitted BIEs">
                <p:messages id="chartMsg" />
                <h:panelGrid columns="2" columnClasses="label, value">
					<p:chart id="chart" type="bar" model="#{topLevelABIEHandler.barModel}" style="width:600px;height:400px">
			            <p:ajax event="itemSelect" listener="#{topLevelABIEHandler.itemSelect}" update=":form:chartMsg" />
			        </p:chart>
                </h:panelGrid>
            </p:panel>
        </p:tab>
 
        <p:tab id="confirm" title="Confirmation">
            <p:panel header="Confirmation">
                <h:panelGrid id="confirmation" columns="3" columnClasses="grid,grid,grid">
  
                </h:panelGrid>
 
                <p:commandButton value="Submit" actionListener="#{topLevelABIEHandler.save}" update="growl" process="@this"/>
            </p:panel>
        </p:tab>
    </p:wizard>
 
</h:form>
	</ui:define>
</ui:composition>
