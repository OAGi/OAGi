package org.oagi.srt.persistence.populate;

import org.apache.commons.io.FileUtils;
import org.springframework.boot.SpringApplication;
import org.springframework.context.ConfigurableApplicationContext;

import java.io.File;
import java.text.SimpleDateFormat;
import java.util.Date;

import static org.oagi.srt.persistence.populate.DataImportScriptPrinter.print;
import static org.oagi.srt.persistence.populate.DataImportScriptPrinter.turnOff;
import static org.oagi.srt.persistence.populate.DataImportScriptPrinter.turnOn;

public class RunAll {

    public static void main(String args[]) throws Exception {
        try (ConfigurableApplicationContext ctx = SpringApplication.run(ImportApplication.class, args)) {
            turnOn();
            try {
                printTitle();
                printSettings();

                P_1_1_PopulateCommonData p1 = ctx.getBean(P_1_1_PopulateCommonData.class);
                p1.run(ctx);

                PopulateModules populateModules = ctx.getBean(PopulateModules.class);
                populateModules.run(ctx);

                PopulateBlobContents populateBlobContents = ctx.getBean(PopulateBlobContents.class);
                populateBlobContents.run(ctx);

                P_1_2_PopulateCDTandCDTSC p2 = ctx.getBean(P_1_2_PopulateCDTandCDTSC.class);
                p2.run(ctx);

                P_1_3_PopulateAgencyIDList p3 = ctx.getBean(P_1_3_PopulateAgencyIDList.class);
                p3.run(ctx);

                P_1_4_PopulateCodeList p4 = ctx.getBean(P_1_4_PopulateCodeList.class);
                p4.run(ctx);

                P_1_5_PopulateDefaultAndUnqualifiedBDT p5 = ctx.getBean(P_1_5_PopulateDefaultAndUnqualifiedBDT.class);
                p5.run(ctx);

                P_1_6_PopulateDTFromMeta p6 = ctx.getBean(P_1_6_PopulateDTFromMeta.class);
                p6.run(ctx);

                P_1_7_PopulateQBDTInDT p7 = ctx.getBean(P_1_7_PopulateQBDTInDT.class);
                p7.run(ctx);

                P_1_8_1_PopulateAccAsccpBccAscc p8 = ctx.getBean(P_1_8_1_PopulateAccAsccpBccAscc.class);
                p8.run(ctx);

                P_1_8_2_PopulateOAGISType p8_2 = ctx.getBean(P_1_8_2_PopulateOAGISType.class);
                p8_2.run(ctx);

                printResetSequences();
            } finally {
                turnOff();
            }
        }
    }

    private static void printTitle() {
        print("-- Generated by Semantic Refinement Tools Import Application");
        print("--   at:        " + new SimpleDateFormat("yyyy-MM-dd HH:mm:ss ZZZ").format(new Date()));
        print("");
        print("");
        print("");
    }

    private static void printSettings() {
        print("SET DEFINE OFF;");
        print("");
    }

    private static void printResetSequences() {
        print("DROP SEQUENCE ACC_ID_SEQ;");
        print("DROP SEQUENCE AGENCY_ID_LIST_ID_SEQ;");
        print("DROP SEQUENCE AGENCY_ID_LIST_VALUE_ID_SEQ;");
        print("DROP SEQUENCE APP_USER_ID_SEQ;");
        print("DROP SEQUENCE ASCCP_ID_SEQ;");
        print("DROP SEQUENCE ASCC_ID_SEQ;");
        print("DROP SEQUENCE BCCP_ID_SEQ;");
        print("DROP SEQUENCE BCC_ID_SEQ;");
        print("DROP SEQUENCE BDT_PRI_RESTRI_ID_SEQ;");
        print("DROP SEQUENCE BDT_SC_PRI_RESTRI_ID_SEQ;");
        print("DROP SEQUENCE BLOB_CONTENT_ID_SEQ;");
        print("DROP SEQUENCE CDT_AWD_PRI_ID_SEQ;");
        print("DROP SEQUENCE CDT_AWD_PRI_XPS_TYP_MAP_ID_SEQ;");
        print("DROP SEQUENCE CDT_PRI_ID_SEQ;");
        print("DROP SEQUENCE CDT_SC_AWD_PRI_ID_SEQ;");
        print("DROP SEQUENCE CDT_SC_AW_PR_XPS_TYP_MP_ID_SEQ;");
        print("DROP SEQUENCE CODE_LIST_ID_SEQ;");
        print("DROP SEQUENCE CODE_LIST_VALUE_ID_SEQ;");
        print("DROP SEQUENCE DT_ID_SEQ;");
        print("DROP SEQUENCE DT_SC_ID_SEQ;");
        print("DROP SEQUENCE MODULE_DEP_ID_SEQ;");
        print("DROP SEQUENCE MODULE_ID_SEQ;");
        print("DROP SEQUENCE NAMESPACE_ID_SEQ;");
        print("DROP SEQUENCE RELEASE_ID_SEQ;");
        print("DROP SEQUENCE XBT_ID_SEQ;");

        print("CREATE SEQUENCE ACC_ID_SEQ START WITH 3783 INCREMENT BY 1 MAXVALUE 999999999999999999999999 MINVALUE 1 ;");
        print("CREATE SEQUENCE AGENCY_ID_LIST_ID_SEQ START WITH 2 INCREMENT BY 1 MAXVALUE 999999999999999999999999 MINVALUE 1 ;");
        print("CREATE SEQUENCE AGENCY_ID_LIST_VALUE_ID_SEQ START WITH 395 INCREMENT BY 1 MAXVALUE 999999999999999999999999 MINVALUE 1 ;");
        print("CREATE SEQUENCE APP_USER_ID_SEQ START WITH 2 INCREMENT BY 1 MAXVALUE 999999999999999999999999 MINVALUE 1 ;");
        print("CREATE SEQUENCE ASCCP_ID_SEQ START WITH 4044 INCREMENT BY 1 MAXVALUE 999999999999999999999999 MINVALUE 1 ;");
        print("CREATE SEQUENCE ASCC_ID_SEQ START WITH 5734 INCREMENT BY 1 MAXVALUE 999999999999999999999999 MINVALUE 1 ;");
        print("CREATE SEQUENCE BCCP_ID_SEQ START WITH 910 INCREMENT BY 1 MAXVALUE 999999999999999999999999 MINVALUE 1 ;");
        print("CREATE SEQUENCE BCC_ID_SEQ START WITH 1857 INCREMENT BY 1 MAXVALUE 999999999999999999999999 MINVALUE 1 ;");
        print("CREATE SEQUENCE BDT_PRI_RESTRI_ID_SEQ START WITH 627 INCREMENT BY 1 MAXVALUE 999999999999999999999999 MINVALUE 1 ;");
        print("CREATE SEQUENCE BDT_SC_PRI_RESTRI_ID_SEQ START WITH 1569 INCREMENT BY 1 MAXVALUE 999999999999999999999999 MINVALUE 1 ;");
        print("CREATE SEQUENCE BLOB_CONTENT_ID_SEQ START WITH 47 INCREMENT BY 1 MAXVALUE 999999999999999999999999 MINVALUE 1 ;");
        print("CREATE SEQUENCE CDT_AWD_PRI_ID_SEQ START WITH 60 INCREMENT BY 1 MAXVALUE 999999999999999999999999 MINVALUE 1 ;");
        print("CREATE SEQUENCE CDT_AWD_PRI_XPS_TYP_MAP_ID_SEQ START WITH 108 INCREMENT BY 1 MAXVALUE 999999999999999999999999 MINVALUE 1 ;");
        print("CREATE SEQUENCE CDT_PRI_ID_SEQ START WITH 12 INCREMENT BY 1 MAXVALUE 999999999999999999999999 MINVALUE 1 ;");
        print("CREATE SEQUENCE CDT_SC_AWD_PRI_ID_SEQ START WITH 280 INCREMENT BY 1 MAXVALUE 999999999999999999999999 MINVALUE 1 ;");
        print("CREATE SEQUENCE CDT_SC_AW_PR_XPS_TYP_MP_ID_SEQ START WITH 315 INCREMENT BY 1 MAXVALUE 999999999999999999999999 MINVALUE 1 ;");
        print("CREATE SEQUENCE CODE_LIST_ID_SEQ START WITH 75 INCREMENT BY 1 MAXVALUE 999999999999999999999999 MINVALUE 1 ;");
        print("CREATE SEQUENCE CODE_LIST_VALUE_ID_SEQ START WITH 1404 INCREMENT BY 1 MAXVALUE 999999999999999999999999 MINVALUE 1 ;");
        print("CREATE SEQUENCE DT_ID_SEQ START WITH 250 INCREMENT BY 1 MAXVALUE 999999999999999999999999 MINVALUE 1 ;");
        print("CREATE SEQUENCE DT_SC_ID_SEQ START WITH 578 INCREMENT BY 1 MAXVALUE 999999999999999999999999 MINVALUE 1 ;");
        print("CREATE SEQUENCE MODULE_DEP_ID_SEQ START WITH 2442 INCREMENT BY 1 MAXVALUE 999999999999999999999999 MINVALUE 1 ;");
        print("CREATE SEQUENCE MODULE_ID_SEQ START WITH 1232 INCREMENT BY 1 MAXVALUE 999999999999999999999999 MINVALUE 1 ;");
        print("CREATE SEQUENCE NAMESPACE_ID_SEQ START WITH 2 INCREMENT BY 1 MAXVALUE 999999999999999999999999 MINVALUE 1 ;");
        print("CREATE SEQUENCE RELEASE_ID_SEQ START WITH 2 INCREMENT BY 1 MAXVALUE 999999999999999999999999 MINVALUE 1 ;");
        print("CREATE SEQUENCE XBT_ID_SEQ START WITH 26 INCREMENT BY 1 MAXVALUE 999999999999999999999999 MINVALUE 1 ;");
        print("");
        print("");
        print("COMMIT;");
        print("");
        print("SET DEFINE ON;");
        print("");
    }
}
